"use strict";(self["webpackChunkai_livestock_fronted"]=self["webpackChunkai_livestock_fronted"]||[]).push([[647],{54278:function(e,a,l){l.d(a,{Xk:function(){return t}});var n=l(36026);const t=e=>(0,n.Z)({url:"/enclosure/select",method:"POST",data:e})},89341:function(e,a,l){l.d(a,{O:function(){return t}});var n=l(36026);const t=e=>(0,n.Z)({url:"/farmowner/select",method:"POST",data:e})},54725:function(e,a,l){l.d(a,{Qe:function(){return t},Z_:function(){return o},ln:function(){return i}});var n=l(36026);const t=e=>(0,n.Z)({url:"/livestock/select",method:"POST",data:e}),o=e=>(0,n.Z)({url:"/livestock/updateencl",method:"PUT",data:e}),i=e=>(0,n.Z)({url:"/livestocktype/select",method:"POST",data:e})},84647:function(e,a,l){l.r(a),l.d(a,{default:function(){return F}});var n=l(384),t=(l(59853),l(8350)),o=(l(85134),l(75311)),i=(l(24971),l(39284),l(24907)),r=(l(40121),l(37336)),s=(l(48504),l(20837),l(77049)),u=(l(75915),l(88464)),c=(l(45177),l(94035)),d=(l(96152),l(29491)),p=(l(50657),l(60096),l(6556)),m=(l(87228),l(66252)),f=l(49963),g=l(3577);const h=(0,m._)("span",{class:"top"},"牧场名称：",-1),w=(0,m._)("span",{class:"top"},"圈舍名称：",-1),k=(0,m._)("span",{class:"top"},"项圈ID：",-1),y=(0,m._)("span",{class:"top"},"体重范围：",-1),v=(0,m._)("span",null,"-",-1),_=(0,m._)("span",{class:"top"},"牲畜体尺：",-1),S=(0,m._)("span",null,"-",-1),b=(0,m.Uk)("搜索"),W=(0,m.Uk)("重置"),C=(0,m.Uk)("添加用户"),V=(0,m.Uk)("批量转移圈舍"),x={class:"app-container"},Q=["textContent"],z=(0,m.Uk)("详情"),P={class:"pagination"},U={class:"dialog-footer"},T=(0,m.Uk)("取 消"),D=(0,m.Uk)("确 定");function O(e,a,l,O,I,j){const H=p.Dv,L=d.BT,K=d.km,E=c.EZ,Z=u.dq,Y=s.mi,q=r.$Y,F=r.eI,R=i.R,X=o.nH,M=o.ly,$=t.d0,A=n.t;return(0,m.wg)(),(0,m.iD)(m.HY,null,[(0,m.Wm)(Z,null,{default:(0,m.w5)((()=>[(0,m.Wm)(H,{span:3},{default:(0,m.w5)((()=>[h])),_:1}),(0,m.Wm)(H,{span:5},{default:(0,m.w5)((()=>[(0,m.Wm)(K,{modelValue:O.enclosureSelectQuery.farm,"onUpdate:modelValue":a[0]||(a[0]=e=>O.enclosureSelectQuery.farm=e),placeholder:"选择养殖场",onChange:O.onFarmOptionChanged,style:{width:"160px"}},{default:(0,m.w5)((()=>[(0,m.Wm)(L,{key:"0",label:"全部",value:""}),((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)(O.farmList,(e=>((0,m.wg)(),(0,m.j4)(L,{key:e.pk,label:e.fields.name,value:e.pk},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,m.Wm)(H,{span:3},{default:(0,m.w5)((()=>[w])),_:1}),(0,m.Wm)(H,{span:5},{default:(0,m.w5)((()=>[(0,m.Wm)(K,{modelValue:O.livestockSelectQuery.enclosure,"onUpdate:modelValue":a[2]||(a[2]=e=>O.livestockSelectQuery.enclosure=e),placeholder:"选择圈舍",onChange:O.onEnclosureOptionChanged,style:{width:"160px"}},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)(O.enclosureList,(e=>((0,m.wg)(),(0,m.j4)(L,{key:e.pk,label:e.fields.name,value:e.pk,onKeyup:a[1]||(a[1]=(0,f.D2)((e=>O.handleSearch()),["enter"]))},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,m.Wm)(H,{span:3},{default:(0,m.w5)((()=>[k])),_:1}),(0,m.Wm)(H,{span:5},{default:(0,m.w5)((()=>[(0,m.Wm)(E,{modelValue:O.livestockSelectQuery.necklace_id,"onUpdate:modelValue":a[3]||(a[3]=e=>O.livestockSelectQuery.necklace_id=e),placeholder:"请输入项圈ID",clearable:"",onKeyup:a[4]||(a[4]=(0,f.D2)((e=>O.handleSearch()),["enter"])),style:{width:"200px"},class:"filter-item"},null,8,["modelValue"])])),_:1})])),_:1}),(0,m.Wm)(Z,null,{default:(0,m.w5)((()=>[(0,m.Wm)(H,{span:3},{default:(0,m.w5)((()=>[y])),_:1}),(0,m.Wm)(H,{span:5},{default:(0,m.w5)((()=>[(0,m.Wm)(E,{modelValue:O.livestockSelectQuery.weight_min,"onUpdate:modelValue":a[5]||(a[5]=e=>O.livestockSelectQuery.weight_min=e),placeholder:"最小体重",clearable:"",oninput:"value=value.replace(/[^\\d]/g,'')",onKeyup:a[6]||(a[6]=(0,f.D2)((e=>O.handleSearch()),["enter"])),style:{width:"98px"},class:"filter-item"},null,8,["modelValue"]),v,(0,m.Wm)(E,{modelValue:O.livestockSelectQuery.weight_max,"onUpdate:modelValue":a[7]||(a[7]=e=>O.livestockSelectQuery.weight_max=e),placeholder:"最大体重",clearable:"",oninput:"value=value.replace(/[^\\d]/g,'')",onKeyup:a[8]||(a[8]=(0,f.D2)((e=>O.handleSearch()),["enter"])),style:{width:"98px"},class:"filter-item"},null,8,["modelValue"])])),_:1}),(0,m.Wm)(H,{span:3},{default:(0,m.w5)((()=>[_])),_:1}),(0,m.Wm)(H,{span:5},{default:(0,m.w5)((()=>[(0,m.Wm)(E,{modelValue:O.livestockSelectQuery.size_min,"onUpdate:modelValue":a[9]||(a[9]=e=>O.livestockSelectQuery.size_min=e),placeholder:"最小体尺",clearable:"",oninput:"value=value.replace(/[^\\d]/g,'')",onKeyup:a[10]||(a[10]=(0,f.D2)((e=>O.handleSearch()),["enter"])),style:{width:"98px"},class:"filter-item"},null,8,["modelValue"]),S,(0,m.Wm)(E,{modelValue:O.farmOwnSelectQuery.size_max,"onUpdate:modelValue":a[11]||(a[11]=e=>O.farmOwnSelectQuery.size_max=e),placeholder:"最大体尺",clearable:"",oninput:"value=value.replace(/[^\\d]/g,'')",onKeyup:a[12]||(a[12]=(0,f.D2)((e=>O.handleSearch()),["enter"])),style:{width:"98px"},class:"filter-item"},null,8,["modelValue"])])),_:1}),(0,m.Wm)(H,{span:8},{default:(0,m.w5)((()=>[(0,m.Wm)(Y,{type:"primary",icon:"Search",onClick:a[13]||(a[13]=e=>O.handleSearch())},{default:(0,m.w5)((()=>[b])),_:1}),(0,m.Wm)(Y,{icon:"Refresh",onClick:a[14]||(a[14]=e=>O.resetQuery())},{default:(0,m.w5)((()=>[W])),_:1})])),_:1})])),_:1}),(0,m.Wm)(Z,{gutter:10},{default:(0,m.w5)((()=>[(0,m.Wm)(H,{span:1.5},{default:(0,m.w5)((()=>[(0,m.Wm)(Y,{type:"primary",plain:"",icon:"Plus",onClick:a[15]||(a[15]=a=>e.openSelectUser())},{default:(0,m.w5)((()=>[C])),_:1})])),_:1},8,["span"]),(0,m.Wm)(H,{span:1.5},{default:(0,m.w5)((()=>[(0,m.Wm)(Y,{type:"warning",plain:"",icon:"Right",disabled:O.hasSelected,onClick:a[16]||(a[16]=e=>O.handleTransferLivestock())},{default:(0,m.w5)((()=>[V])),_:1},8,["disabled"])])),_:1},8,["span"])])),_:1}),(0,m._)("div",x,[(0,m.wy)(((0,m.wg)(),(0,m.j4)(F,{data:O.tableData,stripe:"",style:{width:"100%"},border:!0,onSelectionChange:O.onSelectionChange},{default:(0,m.w5)((()=>[(0,m.Wm)(q,{type:"selection",width:"55"}),(0,m.Wm)(q,{label:"序号",width:"50",type:"index",align:"center"},{default:(0,m.w5)((e=>[(0,m._)("span",{textContent:(0,g.zw)(O.getIndex(e.$index))},null,8,Q)])),_:1}),(0,m.Wm)(q,{label:"牲畜类型",align:"center","show-overflow-tooltip":!0},{default:(0,m.w5)((e=>[(0,m.Uk)((0,g.zw)("1"==e.row.fields.livestock_type?"牛":e.row.pk),1)])),_:1}),(0,m.Wm)(q,{label:"牲畜编号",align:"center",prop:"pk","show-overflow-tooltip":!0}),(0,m.Wm)(q,{label:"项圈编号",align:"center","show-overflow-tooltip":!0},{default:(0,m.w5)((e=>[(0,m.Uk)((0,g.zw)(e.row.fields.necklace?e.row.fields.necklace:"无"),1)])),_:1}),(0,m.Wm)(q,{label:"体尺",align:"center",prop:"fields.size","show-overflow-tooltip":!0}),(0,m.Wm)(q,{label:"体重",align:"center",prop:"fields.weight","show-overflow-tooltip":!0}),(0,m.Wm)(q,{label:"创建时间",align:"center","show-overflow-tooltip":!0},{default:(0,m.w5)((e=>[(0,m.Uk)((0,g.zw)(O.formatTime(e.row.fields.create_time)),1)])),_:1}),(0,m.Wm)(q,{label:"最后更新时间",align:"center","show-overflow-tooltip":!0},{default:(0,m.w5)((e=>[(0,m.Uk)((0,g.zw)(O.formatTime(e.row.fields.update_time)),1)])),_:1}),(0,m.Wm)(q,{label:"操作",align:"center",width:"160px","class-name":"small-padding fixed-width"},{default:(0,m.w5)((e=>[(0,m.Wm)(Y,{link:"",type:"primary",icon:"Tickets"},{default:(0,m.w5)((()=>[z])),_:1})])),_:1})])),_:1},8,["data","onSelectionChange"])),[[A,O.loading]]),(0,m._)("div",P,[(0,m.Wm)(R,{background:"",layout:"total, sizes, prev, pager, next","current-page":O.pageParams.pageIndex,"onUpdate:current-page":a[17]||(a[17]=e=>O.pageParams.pageIndex=e),"page-size":O.pageParams.pageSize,"onUpdate:page-size":a[18]||(a[18]=e=>O.pageParams.pageSize=e),total:O.pageParams.pageTotal,"page-sizes":[1,5,10,20,30,50,100],onCurrentChange:O.handlePageChange,onSizeChange:O.handleSizeChange},null,8,["current-page","page-size","total","onCurrentChange","onSizeChange"])]),(0,m.Wm)($,{title:"转移圈舍",modelValue:O.transferParams.dialogVisible,"onUpdate:modelValue":a[23]||(a[23]=e=>O.transferParams.dialogVisible=e),width:"40%",ref:"transferDialog"},{footer:(0,m.w5)((()=>[(0,m._)("span",U,[(0,m.Wm)(Y,{onClick:a[21]||(a[21]=e=>O.transferParams.dialogVisible=!1)},{default:(0,m.w5)((()=>[T])),_:1}),(0,m.Wm)(Y,{type:"primary",onClick:a[22]||(a[22]=e=>O.transferParams.handleSubmit()),disabled:O.transferParams.hasSelectedEncl},{default:(0,m.w5)((()=>[D])),_:1},8,["disabled"])])])),default:(0,m.w5)((()=>[(0,m.Wm)(M,{"label-width":"100px","label-position":"left",style:{width:"400px","margin-left":"50px"},ref:"transferForm"},{default:(0,m.w5)((()=>[(0,m.Wm)(X,{label:"牧场名称"},{default:(0,m.w5)((()=>[(0,m.Wm)(K,{modelValue:O.transferParams.enclSelectQuery.farm,"onUpdate:modelValue":a[19]||(a[19]=e=>O.transferParams.enclSelectQuery.farm=e),placeholder:"选择指定牧场",style:{width:"200px"},class:"inline-input",onChange:O.transferParams.onFarmOptionChanged},{default:(0,m.w5)((()=>[(0,m.Wm)(L,{key:"0",label:"全部",value:""}),((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)(O.farmList,(e=>((0,m.wg)(),(0,m.j4)(L,{key:e.pk,label:e.fields.name,value:e.pk},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,m.Wm)(X,{label:"目标圈舍"},{default:(0,m.w5)((()=>[(0,m.Wm)(K,{modelValue:O.transferParams.livestockTransferQuery.enclosure_id,"onUpdate:modelValue":a[20]||(a[20]=e=>O.transferParams.livestockTransferQuery.enclosure_id=e),placeholder:"选择目标圈舍",style:{width:"200px"},class:"inline-input",onChange:O.transferParams.onEnclOptionChanged},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)(O.transferParams.enclList,(e=>((0,m.wg)(),(0,m.j4)(L,{key:e.pk,label:e.fields.name,value:e.pk},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})])),_:1},512)])),_:1},8,["modelValue"])])],64)}var I=l(42119),j=l(2262),H=l(89341),L=l(54278),K=l(54725),E=l(45244),Z={setup(){const e=(0,I.yj)(),a=(0,j.iH)(!1),l=(0,j.qj)({}),n=(0,j.iH)([]),t=(0,j.qj)({}),o=(0,j.iH)([]),i=(0,j.qj)({dialogVisible:!1,enclSelectQuery:{},enclList:[],livestockTransferQuery:{},hasSelectedEncl:!0,onFarmOptionChanged:()=>{(0,L.Xk)(i.enclSelectQuery).then((e=>{i.enclList=e.data}))},onEnclOptionChanged:()=>{i.hasSelectedEncl=!1},handleSubmit:()=>{const e=i.livestockTransferQuery.id.join(),a=new Array(i.livestockTransferQuery.id.length).fill(i.livestockTransferQuery.enclosure_id).join();console.log("牲畜ID",e,"目标圈舍ID",a),(0,K.Z_)({id:e,enclosure_id:a}).then((e=>{console.log("转圈res.message",e.message),E.z8.success(e.message[0])})),i.dialogVisible=!1,g()}}),r=(0,j.qj)({}),s=(0,j.iH)([]),u=(0,j.iH)(!0),c=(0,j.iH)([]),d=(0,j.qj)({pageIndex:1,pageSize:5,pageTotal:0});(0,j.iH)([]);async function p(){await(0,H.O)(l).then((e=>{n.value=e.data}))}async function f(){await(0,L.Xk)(t).then((e=>{o.value=e.data}))}async function g(){await(0,K.Qe)(r).then((e=>{s.value=e.data})),s.value?(d.pageTotal=s.value.length,h(d.pageIndex,d.pageSize)):(d.pageTotal=0,c.value=[])}function h(e,a){const l=(e-1)*a,n=l+a;c.value=s.value.slice(l,n)}function w(e){d.pageIndex=e,h(d.pageIndex,d.pageSize)}function k(e){d.pageSize=e,h(1,d.pageSize)}function y(e){return(d.pageIndex-1)*d.pageSize+e+1}function v(e){const a=new Date(e),l=a.getFullYear(),n=("0"+(a.getMonth()+1)).slice(-2),t=("0"+a.getDate()).slice(-2),o=("0"+a.getHours()).slice(-2),i=("0"+a.getMinutes()).slice(-2),r=("0"+a.getSeconds()).slice(-2);return l+"-"+n+"-"+t+" "+o+":"+i+":"+r}function _(e){r.enclosure="",f()}function S(e){}function b(){g()}function W(){t.farm="",Object.keys(r).forEach((e=>{delete r[e]}))}function C(e){i.livestockTransferQuery.id=e.map((e=>e.pk)),u.value=!e.length}function V(){i.dialogVisible=!0}return(0,m.bv)((()=>{e.params&&Object.keys(e.params).length>0&&(console.log("route.params",e.params),t.farm=parseInt(e.params.farmId),r.enclosure=parseInt(e.params.enclosureId),f(),g())})),p(),g(),{loading:a,farmOwnSelectQuery:l,farmList:n,enclosureSelectQuery:t,enclosureList:o,transferParams:i,livestockSelectQuery:r,livestockList:s,hasSelected:u,tableData:c,pageParams:d,handlePageChange:w,handleSizeChange:k,getIndex:y,formatTime:v,onFarmOptionChanged:_,onEnclosureOptionChanged:S,handleSearch:b,resetQuery:W,onSelectionChange:C,handleTransferLivestock:V}}},Y=l(83744);const q=(0,Y.Z)(Z,[["render",O]]);var F=q},75915:function(e,a,l){l(235)},13171:function(e,a,l){l(3392)},87228:function(e,a,l){l(3392)},85134:function(e,a,l){l(3392)},39284:function(e,a,l){l(3392)},24971:function(e,a,l){l(3392)},96152:function(e,a,l){l(93979)},93979:function(e,a,l){l(3392)},59853:function(e,a,l){l(3392)},60096:function(e,a,l){l(56450)},56450:function(e,a,l){l(3392)},40121:function(e,a,l){l(3392),l(40109)},45177:function(e,a,l){l(3392)},81748:function(e,a,l){l(3392)},50657:function(e,a,l){l(40109)},40109:function(e,a,l){l(3392),l(93979),l(45705),l(56450),l(81748),l(30942)},20837:function(e,a,l){l(3392),l(13171),l(45705)},48504:function(e,a,l){l(3392),l(13171),l(45705),l(39777),l(81748)},45705:function(e,a,l){l(3392)}}]);